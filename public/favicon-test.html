<!DOCTYPE html>
<html>
<head>
    <title>Force Cache Favicon</title>
    <style>body { background: #4C5C13; color: white; padding: 20px; }</style>
</head>
<body>
<h1>Принудительное кэширование favicon...</h1>

<script>
    // Многократная загрузка иконки разными способами
    function forceCache() {
        console.log('Начало принудительного кэширования...');

        // Способ 1: через Image (самый эффективный)
        for(let i = 0; i < 10; i++) {
            setTimeout(() => {
                const img = new Image();
                img.src = '/favicon.ico?img=' + i + '_' + Date.now();
                console.log('Загрузка через Image #' + i);
            }, i * 200);
        }

        // Способ 2: через iframe
        setTimeout(() => {
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.srcdoc = `
                <html>
                <head><link rel="icon" href="/favicon.ico?iframe=${Date.now()}"></head>
                <body></body>
                </html>
            `;
            document.body.appendChild(iframe);
            console.log('Загрузка через iframe');
        }, 2500);

        // Способ 3: через fetch
        setTimeout(() => {
            fetch('/favicon.ico?fetch=' + Date.now())
                .then(() => console.log('Загрузка через fetch'));
        }, 3000);

        // Способ 4: через link element динамически
        setTimeout(() => {
            const link = document.createElement('link');
            link.rel = 'icon';
            link.href = '/favicon.ico?link=' + Date.now();
            document.head.appendChild(link);
            console.log('Загрузка через динамический link');
        }, 3500);

        // Сообщение о завершении
        setTimeout(() => {
            console.log('Кэширование завершено. Закройте эту вкладку.');
            document.body.innerHTML += '<p>✅ Кэширование завершено. Закройте эту вкладку и вернитесь на основной сайт.</p>';
        }, 5000);
    }

    // Запускаем при загрузке страницы
    window.onload = forceCache;
</script>
</body>
</html>